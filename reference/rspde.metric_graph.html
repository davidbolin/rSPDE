<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Matern rSPDE model object for metric graphs in INLA — rspde.metric_graph • rSPDE</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Matern rSPDE model object for metric graphs in INLA — rspde.metric_graph"><meta name="description" content="Creates an INLA object for a stationary Matern model on a metric graph with
general smoothness parameter."><meta property="og:description" content="Creates an INLA object for a stationary Matern model on a metric graph with
general smoothness parameter."><meta property="og:image" content="https://davidbolin.github.io/rSPDE/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rSPDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rSPDE.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/rspde_inla.html">R-INLA implementation of the rational SPDE approach</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_inlabru.html">inlabru implementation of the rational SPDE approach</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_cov.html">Rational approximation with the rSPDE package</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_base.html">Operator-based rational approximation</a></li>
    <li><a class="dropdown-item" href="../articles/intrinsic.html">Intrinsic models</a></li>
    <li><a class="dropdown-item" href="../articles/build_source.html">Building the rSPDE package from source on Mac and Linux</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/rSPDE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Matern rSPDE model object for metric graphs in INLA</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/rSPDE/blob/devel-src/R/inla_rspde.R" class="external-link"><code>R/inla_rspde.R</code></a></small>
      <div class="d-none name"><code>rspde.metric_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an INLA object for a stationary Matern model on a metric graph with
general smoothness parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rspde.metric_graph</span><span class="op">(</span></span>
<span>  <span class="va">graph_obj</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu.upper.bound <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  rspde.order <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  B.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  B.range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  parameterization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matern"</span>, <span class="st">"spde"</span><span class="op">)</span>,</span>
<span>  B.tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  B.kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  start.nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta.prior.mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta.prior.prec <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  prior.std.dev.nominal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior.range.nominal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.kappa.mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.tau.mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.lstd.dev <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.lrange <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.ltau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.lkappa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.theta.param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta"</span>, <span class="st">"spde"</span><span class="op">)</span>,</span>
<span>  prior.nu.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lognormal"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>  nu.prec.inc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type.rational.approx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chebfun"</span>, <span class="st">"brasil"</span>, <span class="st">"chebfunLB"</span><span class="op">)</span>,</span>
<span>  shared_lib <span class="op">=</span> <span class="st">"INLA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph-obj">graph_obj<a class="anchor" aria-label="anchor" href="#arg-graph-obj"></a></dt>
<dd><p>The graph object to build the model. Needs to be of class <code>metric_graph</code>. It should have a built mesh.
If the mesh is not built, one will be built using h=0.01 as default.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>The width of the mesh in case the mesh was not built.</p></dd>


<dt id="arg-nu-upper-bound">nu.upper.bound<a class="anchor" aria-label="anchor" href="#arg-nu-upper-bound"></a></dt>
<dd><p>Upper bound for the smoothness parameter.</p></dd>


<dt id="arg-rspde-order">rspde.order<a class="anchor" aria-label="anchor" href="#arg-rspde-order"></a></dt>
<dd><p>The order of the covariance-based rational SPDE approach.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>If nu is set to a parameter, nu will be kept fixed and will not
be estimated. If nu is <code>NULL</code>, it will be estimated.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>INLA debug argument</p></dd>


<dt id="arg-b-sigma">B.sigma<a class="anchor" aria-label="anchor" href="#arg-b-sigma"></a></dt>
<dd><p>Matrix with specification of log-linear model for \(\sigma\). Will be used if <code>parameterization = 'matern'</code>.</p></dd>


<dt id="arg-b-range">B.range<a class="anchor" aria-label="anchor" href="#arg-b-range"></a></dt>
<dd><p>Matrix with specification of log-linear model for \(\rho\), which is a range-like parameter (it is exactly the range parameter in the stationary case). Will be used if <code>parameterization = 'matern'</code>.</p></dd>


<dt id="arg-parameterization">parameterization<a class="anchor" aria-label="anchor" href="#arg-parameterization"></a></dt>
<dd><p>Which parameterization to use? <code>matern</code> uses range, std. deviation and nu (smoothness). <code>spde</code> uses kappa, tau and nu (smoothness). The default is <code>matern</code>.</p></dd>


<dt id="arg-b-tau">B.tau<a class="anchor" aria-label="anchor" href="#arg-b-tau"></a></dt>
<dd><p>Matrix with specification of log-linear model for \(\tau\). Will be used if <code>parameterization = 'spde'</code>.</p></dd>


<dt id="arg-b-kappa">B.kappa<a class="anchor" aria-label="anchor" href="#arg-b-kappa"></a></dt>
<dd><p>Matrix with specification of log-linear model for \(\kappa\). Will be used if <code>parameterization = 'spde'</code>.</p></dd>


<dt id="arg-start-nu">start.nu<a class="anchor" aria-label="anchor" href="#arg-start-nu"></a></dt>
<dd><p>Starting value for nu.</p></dd>


<dt id="arg-start-theta">start.theta<a class="anchor" aria-label="anchor" href="#arg-start-theta"></a></dt>
<dd><p>Starting values for the model parameters. In the stationary case, if <code>parameterization='matern'</code>, then <code>theta[1]</code> is the std.dev and <code>theta[2]</code> is the range parameter.
If <code>parameterization = 'spde'</code>, then <code>theta[1]</code> is <code>tau</code> and <code>theta[2]</code> is <code>kappa</code>.</p></dd>


<dt id="arg-prior-nu">prior.nu<a class="anchor" aria-label="anchor" href="#arg-prior-nu"></a></dt>
<dd><p>a list containing the elements <code>mean</code> and <code>prec</code>
for beta distribution, or <code>loglocation</code> and <code>logscale</code> for a
truncated lognormal distribution. <code>loglocation</code> stands for
the location parameter of the truncated lognormal distribution in the log
scale. <code>prec</code> stands for the precision of a beta distribution.
<code>logscale</code> stands for the scale of the truncated lognormal
distribution on the log scale. Check details below.</p></dd>


<dt id="arg-theta-prior-mean">theta.prior.mean<a class="anchor" aria-label="anchor" href="#arg-theta-prior-mean"></a></dt>
<dd><p>A vector for the mean priors of <code>theta</code>.</p></dd>


<dt id="arg-theta-prior-prec">theta.prior.prec<a class="anchor" aria-label="anchor" href="#arg-theta-prior-prec"></a></dt>
<dd><p>A precision matrix for the prior of <code>theta</code>.</p></dd>


<dt id="arg-prior-std-dev-nominal">prior.std.dev.nominal<a class="anchor" aria-label="anchor" href="#arg-prior-std-dev-nominal"></a></dt>
<dd><p>Prior std. deviation to be used for the priors and for the starting values.</p></dd>


<dt id="arg-prior-range-nominal">prior.range.nominal<a class="anchor" aria-label="anchor" href="#arg-prior-range-nominal"></a></dt>
<dd><p>Prior range to be used for the priors and for the starting values.</p></dd>


<dt id="arg-prior-kappa-mean">prior.kappa.mean<a class="anchor" aria-label="anchor" href="#arg-prior-kappa-mean"></a></dt>
<dd><p>Prior kappa to be used for the priors and for the starting values.</p></dd>


<dt id="arg-prior-tau-mean">prior.tau.mean<a class="anchor" aria-label="anchor" href="#arg-prior-tau-mean"></a></dt>
<dd><p>Prior tau to be used for the priors and for the starting values.</p></dd>


<dt id="arg-start-lstd-dev">start.lstd.dev<a class="anchor" aria-label="anchor" href="#arg-start-lstd-dev"></a></dt>
<dd><p>Starting value for log of std. deviation. Will not be used if start.ltau is non-null. Will be only used in the stationary case and if <code>parameterization = 'matern'</code>.</p></dd>


<dt id="arg-start-lrange">start.lrange<a class="anchor" aria-label="anchor" href="#arg-start-lrange"></a></dt>
<dd><p>Starting value for log of range. Will not be used if start.lkappa is non-null. Will be only used in the stationary case and if <code>parameterization = 'matern'</code>.</p></dd>


<dt id="arg-start-ltau">start.ltau<a class="anchor" aria-label="anchor" href="#arg-start-ltau"></a></dt>
<dd><p>Starting value for log of tau. Will be only used in the stationary case and if <code>parameterization = 'spde'</code>.</p></dd>


<dt id="arg-start-lkappa">start.lkappa<a class="anchor" aria-label="anchor" href="#arg-start-lkappa"></a></dt>
<dd><p>Starting value for log of kappa. Will be only used in the stationary case and if <code>parameterization = 'spde'</code>.</p></dd>


<dt id="arg-prior-theta-param">prior.theta.param<a class="anchor" aria-label="anchor" href="#arg-prior-theta-param"></a></dt>
<dd><p>Should the lognormal prior be on <code>theta</code> or on the SPDE parameters (<code>tau</code> and <code>kappa</code> on the stationary case)?</p></dd>


<dt id="arg-prior-nu-dist">prior.nu.dist<a class="anchor" aria-label="anchor" href="#arg-prior-nu-dist"></a></dt>
<dd><p>The distribution of the smoothness parameter.
The current options are "beta" or "lognormal". The default is "lognormal".</p></dd>


<dt id="arg-nu-prec-inc">nu.prec.inc<a class="anchor" aria-label="anchor" href="#arg-nu-prec-inc"></a></dt>
<dd><p>Amount to increase the precision in the beta prior
distribution. Check details below.</p></dd>


<dt id="arg-type-rational-approx">type.rational.approx<a class="anchor" aria-label="anchor" href="#arg-type-rational-approx"></a></dt>
<dd><p>Which type of rational approximation
should be used? The current types are "chebfun", "brasil" or "chebfunLB".</p></dd>


<dt id="arg-shared-lib">shared_lib<a class="anchor" aria-label="anchor" href="#arg-shared-lib"></a></dt>
<dd><p>Which shared lib to use for the cgeneric implementation?
If "INLA", it will use the shared lib from INLA's installation. If 'rSPDE', then
it will use the local installation (does not work if your installation is from CRAN).
Otherwise, you can directly supply the path of the .so (or .dll) file.</p></dd>


<dt id="arg-prior-kappa">prior.kappa<a class="anchor" aria-label="anchor" href="#arg-prior-kappa"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation on the log scale.</p></dd>


<dt id="arg-prior-tau">prior.tau<a class="anchor" aria-label="anchor" href="#arg-prior-tau"></a></dt>
<dd><p>a list containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation on the log scale.</p></dd>


<dt id="arg-prior-range">prior.range<a class="anchor" aria-label="anchor" href="#arg-prior-range"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation on the log scale. Will not be used if prior.kappa is non-null.</p></dd>


<dt id="arg-prior-std-dev">prior.std.dev<a class="anchor" aria-label="anchor" href="#arg-prior-std-dev"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation on the log scale. Will not be used if prior.tau is non-null.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An INLA model.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Bolin, Alexandre Simas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

