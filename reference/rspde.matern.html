<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matern rSPDE model object for INLA — rspde.matern • rSPDE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Matern rSPDE model object for INLA — rspde.matern" />
<meta property="og:description" content="Create an INLA object for a stationary Matern model with general 
smoothness parameter." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rSPDE</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.6.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rSPDE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rspde_base.html">Using the rational approximation with the `rSPDE` package</a>
    </li>
    <li>
      <a href="../articles/rspde_cov.html">Using the covariance-based rational approximation with the `rSPDE` package</a>
    </li>
    <li>
      <a href="../articles/rspde_inla.html">R-INLA implementation of the covariance-based rational approximation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/davidbolin/rSPDE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matern rSPDE model object for INLA</h1>
    <small class="dont-index">Source: <a href='https://github.com/davidbolin/rSPDE/blob/master/R/inla_rspde.R'><code>R/inla_rspde.R</code></a></small>
    <div class="hidden name"><code>rspde.matern.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create an INLA object for a stationary Matern model with general 
smoothness parameter.</p>
    </div>

    <pre class="usage"><span class='fu'>rspde.matern</span><span class='op'>(</span>
  <span class='va'>mesh</span>,
  nu_upper_bound <span class='op'>=</span> <span class='fl'>4</span>,
  rspde_order <span class='op'>=</span> <span class='fl'>2</span>,
  nu <span class='op'>=</span> <span class='cn'>NULL</span>,
  sharp <span class='op'>=</span> <span class='cn'>TRUE</span>,
  debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  optimize <span class='op'>=</span> <span class='cn'>TRUE</span>,
  prior.kappa <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior.nu <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior.tau <span class='op'>=</span> <span class='cn'>NULL</span>,
  start.lkappa <span class='op'>=</span> <span class='cn'>NULL</span>,
  start.nu <span class='op'>=</span> <span class='cn'>NULL</span>,
  start.ltau <span class='op'>=</span> <span class='cn'>NULL</span>,
  prior.nu.dist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"beta"</span>, <span class='st'>"lognormal"</span><span class='op'>)</span>,
  nu.prec.inc <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mesh</th>
      <td><p>The mesh to build the model. Should be an <code>inla.mesh</code> or
an <code>inla.mesh.1d</code> object.</p></td>
    </tr>
    <tr>
      <th>nu_upper_bound</th>
      <td><p>Upper bound for the smoothness parameter.</p></td>
    </tr>
    <tr>
      <th>rspde_order</th>
      <td><p>The order of the covariance-based rational SPDE approach.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>If nu is set to a parameter, nu will be kept fixed and will not be estimated.
If nu is <code>NULL</code>, it will be estimated.</p></td>
    </tr>
    <tr>
      <th>sharp</th>
      <td><p>The sparsity graph should have the correct sparsity (costs more to perform
a sparsity analysis) or an upper bound for the sparsity? If <code>TRUE</code>, the graph
will have the correct sparsity.</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>INLA debug argument.</p></td>
    </tr>
    <tr>
      <th>optimize</th>
      <td><p>Should the model be optimized? In this case the sparsities of
the matrices will be analyzed.</p></td>
    </tr>
    <tr>
      <th>prior.kappa</th>
      <td><p>a <code>list</code> containing the elements <code>meanlog</code> and <code>sdlog</code>, that is,
the mean and standard deviation on the log scale.</p></td>
    </tr>
    <tr>
      <th>prior.nu</th>
      <td><p>a list containing the elements <code>mean</code> and <code>prec</code> for beta distribution,
or <code>meanlog</code> and <code>sdlog</code> for a truncated lognormal distribution. <code>meanlog</code> stands for
the mean on the log scale. <code>prec</code> stands for the precision of a beta distribution.
<code>sdlog</code> stands for the standard deviation on the log scale. Check details below.</p></td>
    </tr>
    <tr>
      <th>prior.tau</th>
      <td><p>a list containing the elements <code>meanlog</code> and <code>sdlog</code>, that is,
the mean and standard deviation on the log scale.</p></td>
    </tr>
    <tr>
      <th>start.lkappa</th>
      <td><p>Starting value for log of kappa.</p></td>
    </tr>
    <tr>
      <th>start.nu</th>
      <td><p>Starting value for nu.</p></td>
    </tr>
    <tr>
      <th>start.ltau</th>
      <td><p>Starting value for log of tau.</p></td>
    </tr>
    <tr>
      <th>prior.nu.dist</th>
      <td><p>The distribution of the smoothness parameter. The current
options are "beta" or "lognormal". The default is "beta".</p></td>
    </tr>
    <tr>
      <th>nu.prec.inc</th>
      <td><p>Amount to increase the precision in the beta prior distribution. Check details below.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An INLA model.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function constructs a stationary Matern rSPDE model to be used with the INLA interface.
The parameters are the range parameter \(\kappa\), the smoothness parameter
\(\nu\) and the variance rescaling parameter \(\tau\).</p>
<p>For this model, an upper bound for the smoothness parameter \(\nu\) should be given. It is
given by the <code>nu_upper_bound</code> argument.</p>
<p>It is very important to notice that the larger the value of <code>nu_upper_bound</code>
the larger the computational cost to fit the model. So, it is generally best
to initially fit a model with a small value of <code>nu_upper_bound</code> and increase it
only if it is really needed (for instance, if the estimated smoothness parameter was
very close to <code>nu_upper_bound</code>).</p>
<p>The following parameterization is used:
$$\log(\theta_1) = \tau,$$
$$\log(\theta_2) = \kappa$$
and for \(\theta_3\), if a beta prior is used, with the beta prior
being taken on the interval \((0,\nu_{UB})\), where \(\nu_{UB}\) is
<code>nu_upper_bound</code>, then the following parameterization
is considered:
$$\log\Big(\frac{\theta_3}{\nu_{UB}-\theta_3}\Big) = \nu.$$
If a truncated lognormal prior is used, where the lognormal is truncated to
the interval \((0,\nu_{UB})\), then the following parameterization
is considered:
$$\log(\theta_3) = \nu.$$</p>
<p>By default, an optimized version of this model is considered. The optimized
version is generally much faster for larger datasets, however it takes more
time to build the model as the sparsity of the graph should be analyzed. 
However, for small datasets, it is possible that the time taken to analyze sparsity
plus fitting the model is larger than the time taken to fit an unoptimized model.
So, for a small dataset it might be convenient to set <code>optimize=FALSE</code>.</p>
<p>A way to use the optimized version but reduce the cost of sparsity analysis
is to set <code>sharp</code> to <code>FALSE</code>. However, it should increase 
the cost of fitting the model. Therefore, one
usually would not benefit from setting the <code>sharp</code> argument to <code>FALSE</code> when
fitting the model to large datasets.</p>
<p>Finally, when considering a beta prior, the beta distribution will be parameterized
in terms of its mean, say \(\mu\) and a precision parameter \(\phi\), which
is such that the variance of the beta distribution is given by \(\mu(1-\mu)/(1+\phi)\). 
The mean of the beta prior is determined by the <code>prior.nu$mean</code>, whereas
the precision parameter is determined by the <code>prior.nu$prec</code>. If <code>prior.nu$prec</code>
is <code>NULL</code> (which is the default case), the precision parameter is taken
as 
$$\phi = \max\Big\{\frac{\nu_{UB}}{\mu}, \frac{\nu_{UB}}{\nu_{UB}-\mu}\Big\} + \text{nu.prec.inc},$$
where \(\mu\) is the prior mean of the smoothness parameter.</p>
<p>This choice of precision parameter is to ensure that the prior beta density
has boundary values equal to zero (where the boundary values are defined
either by continuity or by limits).</p>
<p>Hence, the higher the value of <code>nu.prec.inc</code> the more informative the prior is.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='co'># \donttest{</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>INLA</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Organizing the data</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>PRprec</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>PRborder</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>PRprec</span><span class='op'>[</span>, <span class='fl'>3</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>31</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Y</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='va'>Y</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span></span>
<span class='r-in'><span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>PRprec</span><span class='op'>[</span><span class='va'>ind</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>alt</span> <span class='op'>&lt;-</span> <span class='va'>PRprec</span><span class='op'>$</span><span class='va'>Altitude</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>seaDist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/spDistsN1.html'>spDists</a></span><span class='op'>(</span><span class='va'>coords</span>, <span class='va'>PRborder</span><span class='op'>[</span><span class='fl'>1034</span><span class='op'>:</span><span class='fl'>1078</span>, <span class='op'>]</span>, longlat <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, </span>
<span class='r-in'><span class='fl'>1</span>, <span class='va'>min</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Creating INLA mesh</span></span>
<span class='r-in'><span class='va'>prdomain</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.nonconvex.hull.html'>inla.nonconvex.hull</a></span><span class='op'>(</span><span class='va'>coords</span>, <span class='op'>-</span><span class='fl'>0.03</span>, <span class='op'>-</span><span class='fl'>0.05</span>, resolution <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>80</span>, <span class='fl'>80</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>prmesh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.mesh.2d.html'>inla.mesh.2d</a></span><span class='op'>(</span>boundary <span class='op'>=</span> <span class='va'>prdomain</span>, max.edge <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.2</span><span class='op'>)</span>, cutoff <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Building the A matrix</span></span>
<span class='r-in'><span class='va'>Abar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rspde.make.A.html'>rspde.make.A</a></span><span class='op'>(</span>mesh <span class='op'>=</span> <span class='va'>prmesh</span>, loc <span class='op'>=</span> <span class='va'>coords</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Building the index</span></span>
<span class='r-in'><span class='va'>mesh.index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='rspde.make.index.html'>rspde.make.index</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"field"</span>, mesh <span class='op'>=</span> <span class='va'>prmesh</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Creating the model</span></span>
<span class='r-in'><span class='va'>rspde_model</span> <span class='op'>&lt;-</span> <span class='fu'>rspde.matern</span><span class='op'>(</span>mesh <span class='op'>=</span> <span class='va'>prmesh</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#INLA stack</span></span>
<span class='r-in'><span class='va'>stk.dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.stack.html'>inla.stack</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>Y</span><span class='op'>)</span>, A <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>Abar</span>, <span class='fl'>1</span><span class='op'>)</span>, tag <span class='op'>=</span> <span class='st'>"est"</span>, </span>
<span class='r-in'>  effects <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mesh.index</span>, </span>
<span class='r-in'>                   <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Intercept <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span class='r-in'>                   <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/group.html'>inla.group</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, </span>
<span class='r-in'>                   lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/group.html'>inla.group</a></span><span class='op'>(</span><span class='va'>coords</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span class='r-in'>                   seaDist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/group.html'>inla.group</a></span><span class='op'>(</span><span class='va'>seaDist</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#INLA formula</span></span>
<span class='r-in'><span class='va'>f.s</span> <span class='op'>&lt;-</span> <span class='va'>y</span> <span class='op'>~</span> <span class='op'>-</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>Intercept</span> <span class='op'>+</span>  <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/f.html'>f</a></span><span class='op'>(</span><span class='va'>seaDist</span>, model <span class='op'>=</span> <span class='st'>"rw1"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/INLA/man/f.html'>f</a></span><span class='op'>(</span><span class='va'>field</span>, model <span class='op'>=</span> <span class='va'>rspde_model</span><span class='op'>)</span>  </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#Fitting the model</span></span>
<span class='r-in'><span class='va'>rspde_fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.html'>inla</a></span><span class='op'>(</span><span class='va'>f.s</span>, family <span class='op'>=</span> <span class='st'>"Gamma"</span>, data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.stack.html'>inla.stack.data</a></span><span class='op'>(</span><span class='va'>stk.dat</span><span class='op'>)</span>, </span>
<span class='r-in'>control.inla<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>int.strategy<span class='op'>=</span><span class='st'>'eb'</span><span class='op'>)</span>,</span>
<span class='r-in'>control.predictor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/INLA/man/inla.stack.html'>inla.stack.A</a></span><span class='op'>(</span><span class='va'>stk.dat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'>#The result</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>rspde_fit</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Call:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    c("inla(formula = f.s, family = \"Gamma\", data = </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    inla.stack.data(stk.dat), ", " control.predictor = list(A = </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    inla.stack.A(stk.dat)), control.inla = list(int.strategy = \"eb\"))" ) </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Time used:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     Pre = 4.03, Running = 25.7, Post = 0.0527, Total = 29.7 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Fixed effects:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>            mean    sd 0.025quant 0.5quant 0.975quant  mode kld</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Intercept 0.649 0.015       0.62    0.649      0.679 0.649   0</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Random effects:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Name	  Model</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     seaDist RW1 model</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    field RGeneric2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Model hyperparameters:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                   mean       sd 0.025quant</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Precision parameter for the Gamma observations   13.90    0.914      12.18</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Precision for seaDist                          7485.82 5128.796    2220.21</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta1 for field                                 -1.36    0.335      -2.04</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta2 for field                                  1.45    0.171       1.11</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta3 for field                                 -1.13    0.216      -1.57</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                                0.5quant 0.975quant    mode</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Precision parameter for the Gamma observations    13.88     15.778   13.83</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Precision for seaDist                           6069.03  21065.023 4282.69</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta1 for field                                  -1.36     -0.674   -1.38</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta2 for field                                   1.46      1.791    1.46</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Theta3 for field                                  -1.13     -0.706   -1.12</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Marginal log-Likelihood:  -1254.72 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Posterior summaries for the linear predictor and the fitted values are computed</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'><span class='co'># }</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Bolin, Alexandre Simas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


