<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates an INLA object for a stationary Matern model with general 
smoothness parameter."><title>Matern rSPDE model object for INLA — rspde.matern • rSPDE</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Roboto%20Slab-0.4.1/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Matern rSPDE model object for INLA — rspde.matern"><meta property="og:description" content="Creates an INLA object for a stationary Matern model with general 
smoothness parameter."><meta property="og:image" content="https://davidbolin.github.io/rSPDE/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rSPDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rSPDE.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/rspde_inla.html">R-INLA implementation of the rational SPDE approach</a>
    <a class="dropdown-item" href="../articles/rspde_cov.html">Rational approximation with the rSPDE package</a>
    <a class="dropdown-item" href="../articles/rspde_base.html">Operator-based rational approximation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidbolin/rSPDE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Matern rSPDE model object for INLA</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/rSPDE/blob/HEAD/R/inla_rspde.R" class="external-link"><code>R/inla_rspde.R</code></a></small>
      <div class="d-none name"><code>rspde.matern.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an INLA object for a stationary Matern model with general 
smoothness parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rspde.matern</span><span class="op">(</span></span>
<span>  <span class="va">mesh</span>,</span>
<span>  nu_upper_bound <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  rspde_order <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sharp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optimize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior.kappa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.lkappa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start.ltau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior.nu.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  nu.prec.inc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type.rational.approx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chebfun"</span>, <span class="st">"brasil"</span>, <span class="st">"chebfunLB"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mesh</dt>
<dd><p>The mesh to build the model. Should be an <code>inla.mesh</code> or
an <code>inla.mesh.1d</code> object.</p></dd>


<dt>nu_upper_bound</dt>
<dd><p>Upper bound for the smoothness parameter.</p></dd>


<dt>rspde_order</dt>
<dd><p>The order of the covariance-based rational SPDE approach.</p></dd>


<dt>nu</dt>
<dd><p>If nu is set to a parameter, nu will be kept fixed and will not be estimated.
If nu is <code>NULL</code>, it will be estimated.</p></dd>


<dt>sharp</dt>
<dd><p>The sparsity graph should have the correct sparsity (costs more to perform
a sparsity analysis) or an upper bound for the sparsity? If <code>TRUE</code>, the graph
will have the correct sparsity.</p></dd>


<dt>debug</dt>
<dd><p>INLA debug argument.</p></dd>


<dt>optimize</dt>
<dd><p>Should the model be optimized? In this case the sparsities of
the matrices will be analyzed.</p></dd>


<dt>prior.kappa</dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and <code>sdlog</code>, that is,
the mean and standard deviation on the log scale.</p></dd>


<dt>prior.nu</dt>
<dd><p>a list containing the elements <code>mean</code> and <code>prec</code> for beta distribution,
or <code>loglocation</code> and <code>logscale</code> for a truncated lognormal distribution. <code>loglocation</code> stands for
the location parameter of the truncated lognormal distribution in the log scale. <code>prec</code> stands for the precision of a beta distribution.
<code>logscale</code> stands for the scale of the truncated lognormal distribution on the log scale. Check details below.</p></dd>


<dt>prior.tau</dt>
<dd><p>a list containing the elements <code>meanlog</code> and <code>sdlog</code>, that is,
the mean and standard deviation on the log scale.</p></dd>


<dt>start.lkappa</dt>
<dd><p>Starting value for log of kappa.</p></dd>


<dt>start.nu</dt>
<dd><p>Starting value for nu.</p></dd>


<dt>start.ltau</dt>
<dd><p>Starting value for log of tau.</p></dd>


<dt>prior.nu.dist</dt>
<dd><p>The distribution of the smoothness parameter. The current
options are "beta" or "lognormal". The default is "beta".</p></dd>


<dt>nu.prec.inc</dt>
<dd><p>Amount to increase the precision in the beta prior distribution. Check details below.</p></dd>


<dt>type.rational.approx</dt>
<dd><p>Which type of rational approximation should be used? The current types are "chebfun", "brasil" or "chebfunLB".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An INLA model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function constructs a stationary Matern rSPDE model to be used with the INLA interface.
The parameters are the range parameter \(\kappa\), the smoothness parameter
\(\nu\) and the variance rescaling parameter \(\tau\).</p>
<p>For this model, an upper bound for the smoothness parameter \(\nu\) should be given. It is
given by the <code>nu_upper_bound</code> argument.</p>
<p>It is very important to notice that the larger the value of <code>nu_upper_bound</code>
the higher the computational cost to fit the model. So, it is generally best
to initially fit a model with a small value of <code>nu_upper_bound</code> and increase it
only if it is really needed (for instance, if the estimated smoothness parameter was
very close to <code>nu_upper_bound</code>).</p>
<p>The following parameterization is used:
$$\log(\tau) = \theta_1,$$
$$\log(\kappa) = \theta_2$$
and for \(\theta_3\) we can have a beta prior
or a truncated lognormal prior distribution. In each case,
the prior distribution has support on the interval \((0,\nu_{UB})\), where \(\nu_{UB}\) is
<code>nu_upper_bound</code>. Then, the following parameterization
is considered:
$$\log\Big(\frac{\nu}{\nu_{UB}-\nu}\Big) = \theta_3.$$</p>
<p>By default, an optimized version of this model is considered. The optimized
version is generally much faster for larger datasets, however it takes more
time to build the model as the sparsity of the graph should be analyzed. 
However, for small datasets, it is possible that the time taken to analyze sparsity
plus fitting the model is larger than the time taken to fit an unoptimized model.
So, for a small dataset it might be convenient to set <code>optimize=FALSE</code>.</p>
<p>A way to use the optimized version but reduce the cost of sparsity analysis
is to set <code>sharp</code> to <code>FALSE</code>. However, it should increase 
the cost of fitting the model. Therefore, one
usually would not benefit from setting the <code>sharp</code> argument to <code>FALSE</code> when
fitting the model to large datasets.</p>
<p>Finally, when considering a beta prior, the beta distribution will be parameterized
in terms of its mean, say \(\mu\) and a precision parameter \(\phi\), which
is such that the variance of the beta distribution is given by \(\mu(\nu_{UB}-\mu)/(1+\phi)\). 
The mean of the beta prior is determined by the <code>prior.nu$mean</code>, whereas
the precision parameter is determined by the <code>prior.nu$prec</code>. If <code>prior.nu$prec</code>
is <code>NULL</code> (which is the default case), the precision parameter is taken
as 
$$\phi = \max\Big\{\frac{\nu_{UB}}{\mu}, \frac{\nu_{UB}}{\nu_{UB}-\mu}\Big\} + \textrm{nu.prec.inc},$$
where \(\mu\) is the prior mean of the smoothness parameter.</p>
<p>This choice of precision parameter is to ensure that the prior beta density
has boundary values equal to zero (where the boundary values are defined
either by continuity or by limits).</p>
<p>Hence, the higher the value of <code>nu.prec.inc</code> the more informative the prior is.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co">#devel version</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">INLA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Organizing the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PRprec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PRborder</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">PRprec</span><span class="op">[</span>, <span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">PRprec</span><span class="op">[</span><span class="va">ind</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alt</span> <span class="op">&lt;-</span> <span class="va">PRprec</span><span class="op">$</span><span class="va">Altitude</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seaDist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spDistsN1.html" class="external-link">spDists</a></span><span class="op">(</span><span class="va">coords</span>, <span class="va">PRborder</span><span class="op">[</span><span class="fl">1034</span><span class="op">:</span><span class="fl">1078</span>, <span class="op">]</span>, longlat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Creating INLA mesh</span></span></span>
<span class="r-in"><span><span class="va">prdomain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.nonconvex.hull.html" class="external-link">inla.nonconvex.hull</a></span><span class="op">(</span><span class="va">coords</span>, <span class="op">-</span><span class="fl">0.03</span>, <span class="op">-</span><span class="fl">0.05</span>, resolution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prmesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.2d.html" class="external-link">inla.mesh.2d</a></span><span class="op">(</span>boundary <span class="op">=</span> <span class="va">prdomain</span>, max.edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">1.2</span><span class="op">)</span>, cutoff <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Building the A matrix</span></span></span>
<span class="r-in"><span><span class="va">Abar</span> <span class="op">&lt;-</span> <span class="fu"><a href="rspde.make.A.html">rspde.make.A</a></span><span class="op">(</span>mesh <span class="op">=</span> <span class="va">prmesh</span>, loc <span class="op">=</span> <span class="va">coords</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Building the index</span></span></span>
<span class="r-in"><span><span class="va">mesh.index</span> <span class="op">&lt;-</span> <span class="fu"><a href="rspde.make.index.html">rspde.make.index</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"field"</span>, mesh <span class="op">=</span> <span class="va">prmesh</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Creating the model</span></span></span>
<span class="r-in"><span><span class="va">rspde_model</span> <span class="op">&lt;-</span> <span class="fu">rspde.matern</span><span class="op">(</span>mesh <span class="op">=</span> <span class="va">prmesh</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#INLA stack</span></span></span>
<span class="r-in"><span><span class="va">stk.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.stack.html" class="external-link">inla.stack</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span>, A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Abar</span>, <span class="fl">1</span><span class="op">)</span>, tag <span class="op">=</span> <span class="st">"est"</span>, </span></span>
<span class="r-in"><span>  effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mesh.index</span>, </span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/group.html" class="external-link">inla.group</a></span><span class="op">(</span><span class="va">coords</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                   lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/group.html" class="external-link">inla.group</a></span><span class="op">(</span><span class="va">coords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   seaDist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/group.html" class="external-link">inla.group</a></span><span class="op">(</span><span class="va">seaDist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#INLA formula</span></span></span>
<span class="r-in"><span><span class="va">f.s</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Intercept</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="va">seaDist</span>, model <span class="op">=</span> <span class="st">"rw1"</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/INLA/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="va">field</span>, model <span class="op">=</span> <span class="va">rspde_model</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Fitting the model</span></span></span>
<span class="r-in"><span><span class="va">rspde_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.html" class="external-link">inla</a></span><span class="op">(</span><span class="va">f.s</span>, family <span class="op">=</span> <span class="st">"Gamma"</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.stack.html" class="external-link">inla.stack.data</a></span><span class="op">(</span><span class="va">stk.dat</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>control.inla<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>int.strategy<span class="op">=</span><span class="st">'eb'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>control.predictor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.stack.html" class="external-link">inla.stack.A</a></span><span class="op">(</span><span class="va">stk.dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The result</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rspde_fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    c("inla.core(formula = formula, family = family, contrasts = contrasts, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ", " data = data, quantiles = quantiles, E = E, offset = offset, ", " </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    scale = scale, weights = weights, Ntrials = Ntrials, strata = strata, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ", " lp.scale = lp.scale, link.covariates = link.covariates, verbose = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    verbose, ", " lincomb = lincomb, selection = selection, control.compute </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    = control.compute, ", " control.predictor = control.predictor, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.family = control.family, ", " control.inla = control.inla, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.fixed = control.fixed, ", " control.mode = control.mode, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.expert = control.expert, ", " control.hazard = control.hazard, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.lincomb = control.lincomb, ", " control.update = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.update, control.lp.scale = control.lp.scale, ", " </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    control.pardiso = control.pardiso, only.hyperparam = only.hyperparam, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ", " inla.call = inla.call, inla.arg = inla.arg, num.threads = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    num.threads, ", " blas.num.threads = blas.num.threads, keep = keep, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    working.directory = working.directory, ", " silent = silent, inla.mode </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    = inla.mode, safe = FALSE, debug = debug, ", " .parent.frame = </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .parent.frame)") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time used:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Pre = 4.93, Running = 24.1, Post = 0.0549, Total = 29.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           mean    sd 0.025quant 0.5quant 0.975quant mode   kld</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept 0.65 0.016      0.619     0.65       0.68   NA 0.008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Name	  Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     seaDist RW1 model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    field RGeneric2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model hyperparameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   mean       sd 0.025quant</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Precision parameter for the Gamma observations   13.85    0.920     12.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Precision for seaDist                          7710.45 6156.363   2056.109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta1 for field                                 -1.38    0.458     -2.312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta2 for field                                  1.40    0.263      0.877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta3 for field                                 -1.07    0.316     -1.674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                0.5quant 0.975quant    mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Precision parameter for the Gamma observations    13.82     15.744   13.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Precision for seaDist                           5957.79  24215.833 3891.59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta1 for field                                  -1.37     -0.499   -1.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta2 for field                                   1.40      1.915    1.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta3 for field                                  -1.07     -0.423   -1.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal log-Likelihood:  -1254.76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  is computed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Posterior summaries for the linear predictor and the fitted values are computed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">#devel.tag</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Bolin, Alexandre Simas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

