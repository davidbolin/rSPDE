<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>rSPDE linear mixed effects models — rspde_lme • rSPDE</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rSPDE linear mixed effects models — rspde_lme"><meta name="description" content="Fitting linear mixed effects model with latent Whittle-Matern models."><meta property="og:description" content="Fitting linear mixed effects model with latent Whittle-Matern models."><meta property="og:image" content="https://davidbolin.github.io/rSPDE/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rSPDE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rSPDE.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/rspde_inla.html">R-INLA implementation of the rational SPDE approach</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_inlabru.html">inlabru implementation of the rational SPDE approach</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_cov.html">Rational approximation with the rSPDE package</a></li>
    <li><a class="dropdown-item" href="../articles/rspde_base.html">Operator-based rational approximation</a></li>
    <li><a class="dropdown-item" href="../articles/intrinsic.html">Intrinsic models</a></li>
    <li><a class="dropdown-item" href="../articles/build_source.html">Building the rSPDE package from source on Mac and Linux</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/rSPDE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>rSPDE linear mixed effects models</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/rSPDE/blob/devel-src/R/rspde_lme.R" class="external-link"><code>R/rspde_lme.R</code></a></small>
      <div class="d-none name"><code>rspde_lme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fitting linear mixed effects model with latent Whittle-Matern models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rspde_lme</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">loc</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  which_repl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optim_method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,</span>
<span>  use_data_from_graph <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  starting_values_latent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_sigma_e <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nu_upper_bound <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  rspde_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  optim_controls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  improve_hessian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hessian_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula object describing the relation between the response variables and the fixed effects. If the response variable is a matrix, each column of the matrix will be treated as a replicate.</p></dd>


<dt id="arg-loc">loc<a class="anchor" aria-label="anchor" href="#arg-loc"></a></dt>
<dd><p>A vector with the names of the columns in <code>data</code> that contain the observation locations, or a <code>matrix</code> or a <code>data.frame</code> containing the observation locations. If the model is of class <code>metric_graph</code>, the locations must be either a <code>matrix</code> or a <code>data.frame</code> with two columns, or a character vector with the names of the two columns. The first column being the number of the edge, and the second column being the normalized position on the edge. If the model is a 2d model, <code>loc</code> must be either a <code>matrix</code> or <code>data.frame</code> with two columns or a character vector with the name of the two columns that contain the location, the first entry corresponding to the <code>x</code> entry and the second corresponding to the <code>y</code> entry.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing the data to be used.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Either an object generated by <code><a href="matern.operators.html">matern.operators()</a></code> or <code><a href="spde.matern.operators.html">spde.matern.operators()</a></code>. If <code>NULL</code>, a simple linear regression will be performed.</p></dd>


<dt id="arg-repl">repl<a class="anchor" aria-label="anchor" href="#arg-repl"></a></dt>
<dd><p>Vector indicating the replicate of each observation. If <code>NULL</code> it will assume there is only one replicate.</p></dd>


<dt id="arg-which-repl">which_repl<a class="anchor" aria-label="anchor" href="#arg-which-repl"></a></dt>
<dd><p>Which replicates to use? If <code>NULL</code> all replicates will be used.</p></dd>


<dt id="arg-optim-method">optim_method<a class="anchor" aria-label="anchor" href="#arg-optim-method"></a></dt>
<dd><p>The method to be used with <code>optim</code> function.</p></dd>


<dt id="arg-use-data-from-graph">use_data_from_graph<a class="anchor" aria-label="anchor" href="#arg-use-data-from-graph"></a></dt>
<dd><p>Logical. Only for models generated from graphs from <code>metric_graph</code> class. In this case, should the data, the locations and the replicates be obtained from the graph object?</p></dd>


<dt id="arg-starting-values-latent">starting_values_latent<a class="anchor" aria-label="anchor" href="#arg-starting-values-latent"></a></dt>
<dd><p>A vector containing the starting values for the latent model. If the latent model was generated by <code><a href="matern.operators.html">matern.operators()</a></code>, then the starting values should be provided as a vector of the form c(tau,kappa). If the model was generated by <code><a href="spde.matern.operators.html">spde.matern.operators()</a></code>, then the starting values should be provided as a vector containing the nonstationary parameters.</p></dd>


<dt id="arg-start-sigma-e">start_sigma_e<a class="anchor" aria-label="anchor" href="#arg-start-sigma-e"></a></dt>
<dd><p>Starting value for the standard deviation of the measurament error.</p></dd>


<dt id="arg-start-alpha">start_alpha<a class="anchor" aria-label="anchor" href="#arg-start-alpha"></a></dt>
<dd><p>Starting value for the smoothness parameter. Will be used if <code>start_nu</code> is not given.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>If <code>NULL</code>, the smoothness parameter will be estimated, otherwise the smoothness parameter will be kept fixed at the provided value. Will be used if <code>nu</code> is not given.</p></dd>


<dt id="arg-start-nu">start_nu<a class="anchor" aria-label="anchor" href="#arg-start-nu"></a></dt>
<dd><p>Starting value for the smoothness parameter.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>If <code>NULL</code>, the smoothness parameter will be estimated, otherwise the smoothness parameter will be kept fixed at the provided value.</p></dd>


<dt id="arg-nu-upper-bound">nu_upper_bound<a class="anchor" aria-label="anchor" href="#arg-nu-upper-bound"></a></dt>
<dd><p>A parameter that limits the maximum value that nu can assume.</p></dd>


<dt id="arg-rspde-order">rspde_order<a class="anchor" aria-label="anchor" href="#arg-rspde-order"></a></dt>
<dd><p>The order of the rational approximation to be used while fitting the model. If not given, the order from the model object will be used.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Indicating whether to use optimParallel or not.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Number of cores to be used if parallel is true.</p></dd>


<dt id="arg-optim-controls">optim_controls<a class="anchor" aria-label="anchor" href="#arg-optim-controls"></a></dt>
<dd><p>Additional controls to be passed to <code>optim</code> or <code>optimParallel</code>.</p></dd>


<dt id="arg-improve-hessian">improve_hessian<a class="anchor" aria-label="anchor" href="#arg-improve-hessian"></a></dt>
<dd><p>Should a more precise estimate of the hessian be obtained? Turning on might increase the overall time.</p></dd>


<dt id="arg-hessian-args">hessian_args<a class="anchor" aria-label="anchor" href="#arg-hessian-args"></a></dt>
<dd><p>List of controls to be used if <code>improve_hessian</code> is <code>TRUE</code>. The list can contain the arguments to be passed to the <code>method.args</code> argument in the <code><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">numDeriv::hessian</a></code> function. See the help of the <code>hessian</code> function in <code>numDeriv</code> package for details. Observe that it only accepts the "Richardson" method for now, the method "complex" is not supported.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the fitted model.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Bolin, Alexandre Simas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

