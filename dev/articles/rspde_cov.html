<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the covariance-based rational approximation with the `rSPDE` package • rSPDE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the covariance-based rational approximation with the `rSPDE` package">
<meta property="og:description" content="rSPDE">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rSPDE</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.6.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rspde.html">An introduction to the `rSPDE` package</a>
    </li>
    <li>
      <a href="../articles/rspde_base.html">Using the rational approximation with the `rSPDE` package</a>
    </li>
    <li>
      <a href="../articles/rspde_cov.html">Using the covariance-based rational approximation with the `rSPDE` package</a>
    </li>
    <li>
      <a href="../articles/rspde_inla.html">R-INLA implementation of the covariance-based rational approximation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/davidbolin/rSPDE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rspde_cov_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the covariance-based rational approximation with the <code>rSPDE</code> package</h1>
                        <h4 class="author">David Bolin, Alexandre B. Simas, Zhen Xiong</h4>
            
            <h4 class="date">2021-12-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/rSPDE/blob/master/vignettes/rspde_cov.Rmd"><code>vignettes/rspde_cov.Rmd</code></a></small>
      <div class="hidden name"><code>rspde_cov.Rmd</code></div>

    </div>

    
    
<p>##Introduction</p>
<p>In this vignette, we will show how to perform likelihood based parameters estimation in practice by covariance-based rational SPDE approach. The following model will be considered: <span class="math display">\[\textbf{y}\vert\textbf{X} \sim N(\overline{\textbf{A}}\textbf{X},\textbf{Q}^{-1}_{\pmb{\epsilon}})\]</span> <span class="math display">\[\textbf{X} \sim N(\textbf{0},\textbf{Q}^{-1})\]</span> <span class="math inline">\(y\)</span> is the observed data, <span class="math inline">\(X\)</span> is the latent Gaussian random field. Recall that in vignette ######(cite the rspde_inla.Rmd vignetter), we introduced the projector matrix <span class="math inline">\(\overline{\textbf{A}}\)</span> and the precision matrix <span class="math inline">\(Q\)</span> in the section ‘Covariance-based rational SPDE approach’.</p>
<p>We will first show how one can simulate the latent filed <span class="math inline">\(X\)</span> so that we can construct the random field <span class="math inline">\(u\)</span>(which gives the observed data by adding measurement error) governed by the SPDE <span class="math display">\[L^{\alpha/2}(\tau u) = \mathcal{W}\]</span> <span class="math inline">\(L = -\Delta +\kappa^2 I\)</span> and <span class="math inline">\(\mathcal{W}\)</span> is the standard Gaussian white noise. <span class="math inline">\(\alpha = \nu + d/2\)</span>, <span class="math inline">\(d\)</span> is dimension of the computational domain. <span class="math inline">\(\nu\)</span>, <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\tau\)</span> are the three parameters we want to estimate. In this vignette, we assume all of the parameters are fixed. With the simulated data, we will illustrate how to construct the log-likelihood and then use ‘optim’ function in R to obtain our estimated parameters.</p>
<p>##Simulation</p>
<p>The two matrix <span class="math inline">\(A\)</span> and <span class="math inline">\(Q\)</span> introduced from the vignette ###(cite old vignette), especially the matrix Q, play important roles in the simulation. Due to the sparsity of <span class="math inline">\(Q\)</span>, to sample the field <span class="math inline">\(X\)</span>, we can exploit the standard method from ###(cite section 2.3 of GMRF book). Namely, we can do Cholesky factorization of Q: <span class="math display">\[ Q = L^TL\]</span> and generate a standard Gaussian vector <span class="math inline">\(Z\)</span>, then <span class="math inline">\(X = L^{-T}Z\)</span> follows the distribution <span class="math inline">\(N(0,Q^{-1})\)</span>. To get the field <span class="math inline">\(u\)</span>, we can simply compute the multiplication: <span class="math inline">\(u = AX\)</span>. To get the observed data <span class="math inline">\(y\)</span>, we just add some noise, say, a Gaussian random vector with zero mean and diagonal covariance matrix.</p>
<p>Now, let us see how to simulate the data with rSPDE package. First, we load INLA package and rSPDE package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">INLA</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## This is INLA_21.12.01 built 2021-12-01 04:58:25 UTC.
##  - See www.r-inla.org/contact-us for how to get help.
##  - To enable PARDISO sparse library; see inla.pardiso()</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://davidbolin.github.io/rSPDE">rSPDE</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'rSPDE'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     simulate</code></pre>
<p>Second, we use INLA package to create mesh and obtain relevant finite element matrices: lumped mass matrix, stiffness matrix and projector matrix.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_FE</span> <span class="op">=</span> <span class="fl">10</span><span class="op">+</span><span class="fl">1</span>
<span class="co"># generate coordinates of mesh, the code is from Alex's tutorial</span>
<span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">N_FE</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">loc_2d_mesh</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">idx</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">idx</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>
<span class="va">loc_2d_mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">loc_2d_mesh</span><span class="op">)</span>
<span class="co"># using INLA to generate mesh base on coordinates</span>
<span class="va">mesh_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.2d.html">inla.mesh.2d</a></span><span class="op">(</span>loc <span class="op">=</span> <span class="va">loc_2d_mesh</span>,max.edge <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fem_mesh_2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.mesh.fem.html">inla.mesh.fem</a></span><span class="op">(</span><span class="va">mesh_2d</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mesh_2d</span><span class="op">)</span></code></pre></div>
<p><img src="rspde_cov_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># lumped mass matrix</span>
<span class="va">C</span> <span class="op">=</span> <span class="va">fem_mesh_2d</span><span class="op">$</span><span class="va">c0</span>
<span class="co"># stiffness matrix</span>
<span class="va">G</span> <span class="op">&lt;-</span> <span class="va">fem_mesh_2d</span><span class="op">$</span><span class="va">g1</span>
<span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/INLA/man/inla.spde.make.A.html">inla.spde.make.A</a></span><span class="op">(</span>mesh<span class="op">=</span><span class="va">mesh_2d</span>, loc<span class="op">=</span><span class="va">loc_2d_mesh</span><span class="op">)</span> </code></pre></div>
<p>Third step, set the true parameters. We can call the built-in function ‘CBrSPDE.matern.operators’ from rSPDE package to incorporate all the necessary information like true parameters and relevant finite element matrices into the object operator_information for future use. For example, the simulation task will take information from this object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nu</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">kappa</span> <span class="op">=</span> <span class="fl">20</span>
<span class="va">sigma2_spde</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="va">nu</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">gamma</a></span><span class="op">(</span><span class="va">nu</span><span class="op">+</span><span class="fl">0.5</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">*</span><span class="va">kappa</span><span class="op">^</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">nu</span><span class="op">)</span><span class="op">)</span>
<span class="va">tau</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma2_spde</span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fl">2</span>
<span class="va">operator_information</span> <span class="op">=</span> <span class="fu"><a href="../reference/CBrSPDE.matern.operators.html">CBrSPDE.matern.operators</a></span> <span class="op">(</span><span class="va">C</span>,
                                 <span class="va">G</span>,
                                 <span class="va">nu</span>,
                                 <span class="va">kappa</span>,
                                 <span class="va">tau</span>,
                                 m<span class="op">=</span><span class="fl">2</span>,
                                 <span class="va">d</span><span class="op">)</span></code></pre></div>
<p>Finally, we can directly call the ‘simulate’ method to get latent field <span class="math inline">\(X\)</span>, then to compute observed data sim_data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_data</span> <span class="op">=</span> <span class="va">A</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="fu"><a href="../reference/simulate.html">simulate</a></span><span class="op">(</span><span class="va">operator_information</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sd<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p>##Computation of log-likelihood function</p>
<p>Given the model from the Introduction section, we can derive the posterior distribution for latent field <span class="math inline">\(X\)</span>:<span class="math display">\[\textbf{X}\vert\textbf{y} \sim N(\pmb{\mu}_{\textbf{X}\vert\textbf{y}},\textbf{Q}^{-1}_{\textbf{X}\vert\textbf{y}})\]</span> where <span class="math display">\[\pmb{\mu}_{\textbf{X}\vert\textbf{y}}=\textbf{Q}^{-1}_{\textbf{X}\vert\textbf{y}}\overline{\textbf{A}}^T\textbf{Q}_{\pmb{\epsilon}}\textbf{y},
\quad
\textbf{Q}_{\textbf{X}\vert\textbf{y}}=\overline{\textbf{A}}^T\textbf{Q}_{\pmb{\epsilon}}\overline{\textbf{A}}+\textbf{Q}\label{posterior}\]</span> <span class="math inline">\(\textbf{Q}_{\pmb{\epsilon}}\)</span> is precision matrix for measurement error.</p>
<p>With this, we can derive the marginal log-likelihood of observed data <span class="math inline">\(y\)</span>: <span class="math display">\[ \pi(y|\nu,\kappa,\tau) \propto  \log{|\textbf{Q}|}+\log{|\textbf{Q}_{\pmb{\epsilon}}|}-\log{|\textbf{Q}_{\textbf{X}\vert\textbf{y}}|}-\pmb{\mu}_{\textbf{X}\vert\textbf{y}}^T\textbf{Q}\pmb{\mu}_{\textbf{X}\vert\textbf{y}}-(\textbf{y}-\overline{\textbf{A}}\pmb{\mu}_{\textbf{X}\vert\textbf{y}})^T\textbf{Q}_{\pmb{\epsilon}}(\textbf{y}-\overline{\textbf{A}}\pmb{\mu}_{\textbf{X}\vert\textbf{y}})\]</span> To estimate parameters, the only thing left is to find the maximum of this log-likelihood function.</p>
<p>To see how can we do it with rSPDE package, we can call the built-in function ‘CBrSPDE.matern.loglike’ to evaluate log-likelihood. To find the maximum, we can use the R built-in function ‘optim’. We define the following ‘loglike_matern’ function to allow ‘optim’ try different choice for each parameters. In this ‘loglike_matern’ function, we put all the input parameters in log-scale and use exp() to scale back to prevent negative values for <span class="math inline">\(\nu\)</span> and <span class="math inline">\(\kappa\)</span> and zero value for <span class="math inline">\(\tau\)</span>. The function ‘loglike_matern’ will output negative log-likelihood due to ‘optim’ function minimize functions by default.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loglike_matern</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">mynu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
  <span class="va">mykappa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
  <span class="va">mytau</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">loglike</span> <span class="op">=</span> <span class="fu"><a href="../reference/CBrSPDE.matern.loglike.html">CBrSPDE.matern.loglike</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">operator_information</span>, Y <span class="op">=</span> <span class="va">sim_data</span>, A<span class="op">=</span><span class="va">A</span>, sigma.e<span class="op">=</span><span class="fl">0.1</span>,user_nu <span class="op">=</span> <span class="va">mynu</span>, user_kappa <span class="op">=</span> <span class="va">mykappa</span>, user_tau <span class="op">=</span> <span class="va">mytau</span><span class="op">)</span>
  <span class="va">loglike</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">loglike</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">loglike</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>With ‘loglike_matern’ function, we can now call ‘optim’ function to perform optimization. Users can use the built-in function ‘get.inital.values.rSPDE’ from rSPDE package to get a good initialization for the optimization. This may help reduce the amount of time for optimization.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set initial nu,kappa and tau for optimization</span>

<span class="va">initial_para</span> <span class="op">=</span> <span class="fu"><a href="../reference/get.inital.values.rSPDE.html">get.inital.values.rSPDE</a></span><span class="op">(</span>mesh<span class="op">=</span><span class="va">mesh_2d</span><span class="op">)</span> <span class="co">#Notice that it will return in log scale.</span>
<span class="co"># let it rip!</span>
<span class="va">timestart</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span><span class="va">initial_para</span>,<span class="va">loglike_matern</span><span class="op">)</span>
<span class="va">timeend</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">runningtime</span><span class="op">&lt;-</span><span class="va">timeend</span><span class="op">-</span><span class="va">timestart</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">runningtime</span><span class="op">)</span></code></pre></div>
<pre><code>## Time difference of 24.64741 secs</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  0.1078284 16.0236604  0.6338765</code></pre>
<p>In order to speed up the optimization, users may also choose the parallel optimization option. In this option, we use the R built-in function ‘optimParallel’. Here we can see ‘optimParallel’ is much more efficient and achieve the same result.</p>
<p>ADD THE CODE HIA</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Bolin, Alexandre Simas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
